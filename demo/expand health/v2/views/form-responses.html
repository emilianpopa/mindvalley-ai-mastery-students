<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Form Responses - ExpandHealth</title>
  <link rel="stylesheet" href="/css/main.css?v=14">
  <link rel="stylesheet" href="/css/form-responses.css?v=16">
</head>
<body>
  <div class="app-container">
    <!-- Sidebar -->
    <aside class="sidebar">
      <div class="sidebar-header">
        <div class="logo-small">
          <span class="logo-icon">‚ú¶</span>
          <span class="logo-text">ExpandHealth</span>
        </div>
      </div>

                        <nav class="sidebar-nav">
        <div class="nav-section-title">AI</div>
        <a href="/" class="nav-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"></path><polyline points="9 22 9 12 15 12 15 22"></polyline></svg>
          <span>Dashboard</span>
        </a>
        <a href="/clients" class="nav-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
          <span>Clients</span>
        </a>

        <div class="nav-section-title">AI ADMIN</div>
        <a href="/forms" class="nav-item active">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M9 11l3 3L22 4"></path><path d="M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11"></path></svg>
          <span>Forms</span>
        </a>
        <a href="/protocol-templates" class="nav-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="18" height="18" rx="2" ry="2"></rect><line x1="3" y1="9" x2="21" y2="9"></line><line x1="9" y1="21" x2="9" y2="9"></line></svg>
          <span>Protocol Templates</span>
        </a>
        <a href="/admin" class="nav-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="3"></circle><path d="M19.4 15a1.65 1.65 0 0 0 .33 1.82l.06.06a2 2 0 0 1 0 2.83 2 2 0 0 1-2.83 0l-.06-.06a1.65 1.65 0 0 0-1.82-.33 1.65 1.65 0 0 0-1 1.51V21a2 2 0 0 1-2 2 2 2 0 0 1-2-2v-.09A1.65 1.65 0 0 0 9 19.4a1.65 1.65 0 0 0-1.82.33l-.06.06a2 2 0 0 1-2.83 0 2 2 0 0 1 0-2.83l.06-.06a1.65 1.65 0 0 0 .33-1.82 1.65 1.65 0 0 0-1.51-1H3a2 2 0 0 1-2-2 2 2 0 0 1 2-2h.09A1.65 1.65 0 0 0 4.6 9a1.65 1.65 0 0 0-.33-1.82l-.06-.06a2 2 0 0 1 0-2.83 2 2 0 0 1 2.83 0l.06.06a1.65 1.65 0 0 0 1.82.33H9a1.65 1.65 0 0 0 1-1.51V3a2 2 0 0 1 2-2 2 2 0 0 1 2 2v.09a1.65 1.65 0 0 0 1 1.51 1.65 1.65 0 0 0 1.82-.33l.06-.06a2 2 0 0 1 2.83 0 2 2 0 0 1 0 2.83l-.06.06a1.65 1.65 0 0 0-.33 1.82V9a1.65 1.65 0 0 0 1.51 1H21a2 2 0 0 1 2 2 2 2 0 0 1-2 2h-.09a1.65 1.65 0 0 0-1.51 1z"></path></svg>
          <span>Admin Settings</span>
        </a>
        <a href="/kb-admin" class="nav-item">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2"></polygon></svg>
          <span>AI Knowledge Base</span>
        </a>

        <div class="nav-section booking-nav">
          <div class="nav-section-title">BOOKING</div>
          <a href="/schedule" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"></rect><rect x="14" y="3" width="7" height="7"></rect><rect x="3" y="14" width="7" height="7"></rect><rect x="14" y="14" width="7" height="7"></rect></svg>
            <span>Dashboard</span>
          </a>
          <a href="/inbox" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M4 4h16c1.1 0 2 .9 2 2v12c0 1.1-.9 2-2 2H4c-1.1 0-2-.9-2-2V6c0-1.1.9-2 2-2z"></path><polyline points="22,6 12,13 2,6"></polyline></svg>
            <span>Inbox</span>
          </a>
          <a href="/pos" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="2" y="3" width="20" height="14" rx="2" ry="2"></rect><line x1="8" y1="21" x2="16" y2="21"></line><line x1="12" y1="17" x2="12" y2="21"></line></svg>
            <span>Point of sale</span>
          </a>
          <div class="nav-dropdown">
            <div class="nav-dropdown-trigger">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
              <span>Classes</span>
              <svg class="nav-dropdown-arrow" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="9 18 15 12 9 6"></polyline></svg>
            </div>
            <div class="nav-dropdown-menu">
              <div class="nav-dropdown-header">CLASSES</div>
              <div class="nav-dropdown-section">SCHEDULING</div>
              <a href="/classes" class="nav-dropdown-item">Schedule</a>
              <a href="/class-templates" class="nav-dropdown-item">Class templates</a>
              <div class="nav-dropdown-section">PRACTITIONERS</div>
              <a href="/substitution-requests" class="nav-dropdown-item">Substitution requests</a>
            </div>
          </div>
          <a href="/appointments" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>
            <span>Appointments</span>
          </a>
          <a href="/community" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
            <span>Community</span>
          </a>
          <a href="/on-demand" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polygon points="5 3 19 12 5 21 5 3"></polygon></svg>
            <span>On-Demand</span>
          </a>
          <a href="/memberships" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"></path><circle cx="12" cy="7" r="4"></circle></svg>
            <span>Memberships</span>
          </a>
          <a href="/customers" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
            <span>Customers</span>
          </a>
          <a href="/leads" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M22 12h-4l-3 9L9 3l-3 9H2"></path></svg>
            <span>Marketing</span>
          </a>
          <a href="/analytics" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="18" y1="20" x2="18" y2="10"></line><line x1="12" y1="20" x2="12" y2="4"></line><line x1="6" y1="20" x2="6" y2="14"></line></svg>
            <span>Analytics</span>
          </a>
          <a href="/financials" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><circle cx="12" cy="12" r="10"></circle><line x1="12" y1="8" x2="12" y2="16"></line><line x1="8" y1="12" x2="16" y2="12"></line></svg>
            <span>Financials</span>
          </a>
        </div>

        <div class="nav-section booking-nav">
          <div class="nav-section-title">STUDIO SET-UP</div>
          <a href="/studio/practitioners" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M17 21v-2a4 4 0 0 0-4-4H5a4 4 0 0 0-4 4v2"></path><circle cx="9" cy="7" r="4"></circle><path d="M23 21v-2a4 4 0 0 0-3-3.87"></path><path d="M16 3.13a4 4 0 0 1 0 7.75"></path></svg>
            <span>Practitioners</span>
          </a>
          <a href="/services" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7.01" y2="7"></line></svg>
            <span>Services</span>
          </a>
          <a href="/studio/locations" class="nav-item">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><path d="M21 10c0 7-9 13-9 13s-9-6-9-13a9 9 0 0 1 18 0z"></path><circle cx="12" cy="10" r="3"></circle></svg>
            <span>Locations</span>
          </a>
        </div>
      </nav>

      <div class="sidebar-footer">
        <button class="ask-ai-btn" onclick="openQuickNotes()">
          <span>üìù</span>
          <span>Quick Notes</span>
        </button>
      </div>
    </aside>

    <!-- Main Content -->
    <main class="main-content">
      <!-- Form Tabs Header -->
      <header class="form-header">
        <a href="/forms" class="back-link">
          <span>‚Äπ</span>
          <span>Back to Forms</span>
        </a>

        <nav class="form-tabs">
          <a href="#" class="form-tab" onclick="navigateToBuilder()">Questions</a>
          <a href="#" class="form-tab" onclick="navigateToSettings()">Form Settings</a>
          <a href="#" class="form-tab" onclick="previewForm()">Preview</a>
          <a href="#" class="form-tab active">Responses</a>
        </nav>

        <div class="form-actions">
          <button class="btn-outline" onclick="saveDraft()">Save as Draft</button>
          <button class="btn-primary-small" id="publishBtn" onclick="togglePublish()">Published</button>
        </div>
      </header>

      <!-- Content -->
      <div class="content">
        <!-- Response Type Tabs -->
        <div class="response-tabs-container">
          <div class="response-tabs">
            <button class="response-tab active" data-tab="clients" onclick="switchTab('clients')">Clients</button>
            <button class="response-tab" data-tab="leads" onclick="switchTab('leads')">Leads</button>
          </div>
        </div>

        <!-- Stats and Search Row -->
        <div class="responses-header">
          <p class="response-count" id="responseCount">0 lead responses</p>
          <div class="search-box">
            <span class="search-icon">üîç</span>
            <input type="text" id="searchInput" placeholder="Search responses" oninput="filterResponses()">
          </div>
        </div>

        <!-- Loading State -->
        <div id="loadingState" class="loading-state">
          <div class="loading-spinner"></div>
          <p>Loading responses...</p>
        </div>

        <!-- Empty State -->
        <div id="emptyState" class="empty-state" style="display: none;">
          <div class="empty-icon">
            <svg width="32" height="32" viewBox="0 0 24 24" fill="none" stroke="#9ca3af" stroke-width="1.5">
              <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
              <polyline points="14 2 14 8 20 8"/>
              <line x1="16" y1="13" x2="8" y2="13"/>
              <line x1="16" y1="17" x2="8" y2="17"/>
            </svg>
          </div>
          <h3>No Responses Yet</h3>
          <p>Share your form to start collecting responses</p>
          <button class="btn-primary" onclick="copyFormLink()">
            üìã Copy Form Link
          </button>
        </div>

        <!-- Responses Table -->
        <div id="responsesTable" class="responses-table-container" style="display: none;">
          <table class="responses-table">
            <thead>
              <tr>
                <th class="sortable" onclick="sortBy('name')">
                  Responder Name
                  <span class="sort-icon">‚áÖ</span>
                </th>
                <th class="sortable" onclick="sortBy('email')">
                  Email Address
                  <span class="sort-icon">‚áÖ</span>
                </th>
                <th class="sortable" onclick="sortBy('date')">
                  Received Date
                  <span class="sort-icon">‚áÖ</span>
                </th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody id="responsesTableBody">
              <!-- Populated by JavaScript -->
            </tbody>
          </table>
        </div>
      </div>
    </main>
  </div>

  <!-- Response Detail Modal -->
  <div id="detailModal" class="modal" style="display: none;">
    <div class="modal-overlay" onclick="closeDetailModal()"></div>
    <div class="modal-content modal-large">
      <div class="modal-header">
        <h2>Response Details</h2>
        <button class="modal-close" onclick="closeDetailModal()">‚úï</button>
      </div>

      <div class="modal-body">
        <!-- Responder Info -->
        <div class="responder-info">
          <div class="info-grid">
            <div class="info-item">
              <label>Name</label>
              <span id="detailName">-</span>
            </div>
            <div class="info-item">
              <label>Email</label>
              <span id="detailEmail">-</span>
            </div>
            <div class="info-item">
              <label>Submitted</label>
              <span id="detailDate">-</span>
            </div>
            <div class="info-item">
              <label>Status</label>
              <span id="detailStatus" class="status-badge">-</span>
            </div>
          </div>
        </div>

        <!-- AI Summary Section -->
        <div class="ai-summary-section" id="aiSummarySection">
          <div class="ai-summary-header">
            <h3>‚ú® AI Summary</h3>
            <button class="btn-outline-small" id="generateSummaryBtn" onclick="generateAISummary()">
              Generate Summary
            </button>
          </div>
          <div id="aiSummaryContent" class="ai-summary-content">
            <p class="ai-summary-placeholder">Click "Generate Summary" to get an AI-powered analysis of this response.</p>
          </div>
        </div>

        <!-- Form Responses -->
        <div class="responses-section">
          <h3>Form Responses</h3>
          <div id="responsesContainer" class="responses-container">
            <!-- Populated dynamically -->
          </div>
        </div>

        <!-- Notes Section -->
        <div class="notes-section">
          <h3>Internal Notes</h3>
          <textarea id="internalNotes" placeholder="Add notes about this response..." rows="3"></textarea>
        </div>
      </div>

      <div class="modal-footer">
        <button class="btn-secondary" onclick="closeDetailModal()">Close</button>
        <button class="btn-danger" id="rejectBtn" onclick="rejectResponse()">
          ‚úï Reject
        </button>
        <button class="btn-success" id="approveBtn" onclick="approveResponse()">
          ‚úì Approve
        </button>
      </div>
    </div>
  </div>

  <!-- Quick Notes Floating Button -->
  <button class="quick-notes-fab" onclick="openQuickNotes()">
    <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
      <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
      <polyline points="14 2 14 8 20 8"/>
      <line x1="16" y1="13" x2="8" y2="13"/>
      <line x1="16" y1="17" x2="8" y2="17"/>
    </svg>
    <span>Quick Notes</span>
  </button>

  <!-- Quick Notes Panel -->
  <div id="quickNotesPanel" class="quick-notes-panel" style="display: none;">
    <div class="quick-notes-header">
      <h3>Quick Notes</h3>
      <button class="close-panel" onclick="closeQuickNotes()">√ó</button>
    </div>
    <div class="quick-notes-content">
      <textarea id="quickNotesText" placeholder="Write your notes here..."></textarea>
      <button class="btn-primary-small" onclick="saveQuickNote()">Save Note</button>
    </div>
  </div>

  <script src="/js/dashboard.js"></script>
  <script src="/js/form-responses.js?v=16"></script>
  <script>
    // Quick Notes functionality
    function openQuickNotes() {
      document.getElementById('quickNotesPanel').style.display = 'block';
    }

    function closeQuickNotes() {
      document.getElementById('quickNotesPanel').style.display = 'none';
    }

    function saveQuickNote() {
      const noteText = document.getElementById('quickNotesText').value;
      if (noteText.trim()) {
        // Save to localStorage for now
        const notes = JSON.parse(localStorage.getItem('quickNotes') || '[]');
        notes.push({
          text: noteText,
          timestamp: new Date().toISOString(),
          page: 'form-responses'
        });
        localStorage.setItem('quickNotes', JSON.stringify(notes));
        document.getElementById('quickNotesText').value = '';
        alert('Note saved!');
      }
    }
  </script>
</body>
</html>
